# SixSideGoGame

本游戏为六边形棋盘围棋游戏，目前版本可以实现账号创建、双人在线对弈、聊天、修改字符（界面）风格，支持不同大小的棋盘（最大可落子点数360，正常围棋为361）。
数据库中记录账户信息、对局信息、棋谱信息、聊天记录。

## 游戏一开始，首先创建Chat类的实例chat。该类主要功能包括：

### 首页菜单 Menu

（当第一局游戏结束，进入的菜单为Menu2，而非首页菜单）

选项为：
	1. 创建房间：连接到服务器，输入并验证用户名与密码，并且在接下来的游戏中执黑。
	2. 进入房间：连接到服务器，输入并验证用户名与密码，并且在接下来的游戏中执白。不能重复登录同一账户。
	3. 创建账户：连接到服务器，输入用户名与密码，如果用户名已经存在于数据库，创建失败。
	4. 建立服务器：连接数据库，输入服务器管理员的账号密码，创建服务器。



### 主循环 Fresh

主线程为监听消息（detectingMsg），同时通过两个布尔值管理  对弈（bGoThread）、打字（cinThread）两个线程。
这两个布尔变量可以由SSGo游戏类来修改。

### 服务器消息处理 detectingInstruct

服务器根据游戏通信协议，对接收到的消息进行分类处理：

	* #Connected：收到连接请求，如果房间已满，对请求方发送RoomFull消息。
	* #CreName：收到创建账户请求，判断账户合法，则添加people表的记录，否则对请求方发送提示消息。
	* #ConName：收到某账户请求创建/进入房间的消息。根据房中人数判断对方执黑或白，或者是否为观战者。并据此广播不同类型的ShowName消息。
	* #CreateSide：收到创建棋盘请求。如果创建棋盘的大小与side值一致，表示双方统一了棋盘大小，广播开始对局的消息。
	* #ConfirmSide：收到确认棋盘的消息。如果棋盘的大小与side值一致，表示双方统一了棋盘大小，广播开始对局的消息。
	* #I：收到对局记录消息，根据不同的坐标值判断：对局记录为落子、停一手，还是认输。如果不是认输，创建record表的记录。
	* #R：收到对局结束消息，根据消息修改game表中的记录（添加胜者、赢的目数），修改people表（增加胜者经验）。
	* #：收到聊天消息，添加chat表记录。


### 客户端消息处理 detectingServer

客户端根据游戏通信协议，对接收到的消息进行分类处理：

	* #NoID：服务器通知账户名或密码错误。
	* #IDex：服务器通知账户已经登录。
	* #RoomFull：服务器通知房间已满。
	* #ConfirmSide：是否确认棋盘大小。进行y/n选择。或者双方已经统一棋盘大小，则实例化myGo游戏成员变量，并显示棋盘。
	* #I：收到对局记录消息，据此修改myGo的enemy坐标。
	* #JieBI：打劫，设置白棋禁止落子点。
	* #JieWI：打劫，设置黑棋禁止落子点。
	* #ShowNameB：设置黑方名字，或显示黑方名字。
	* #ShowNameW：设置白方名字，或显示白方名字。
	* #：收到聊天消息，显示聊天消息。




## myGo游戏类，其主要功能包括：

### 主循环 start

在循环中有两个分支，用于判断是否为自己的回合。
对方的回合：己方按空格可以打字聊天。如果enemy的坐标发生了变化（在主循环中被更改），说明对方已经进行了操作，回合转换。
己方的回合：主要用了Chose函数来读取键盘操作：

	* WSAD移动光标，选择落子位置。
	* 回车：落子（putChess）。
	* Esc：呼叫菜单，可以选择停一手、认输或者更改字符（界面）的风格。
	* 空格：设置cinThread为真，进入打字聊天状态。



### wsad移动操作

移动方法：对于record[列号i][行号j]，判断其周围的字符记录，根据符号移动光标。

判断是否能落子 canDown

### canDown(Bb)?
wsad四个方向看有无nu？

	* 有，直接放子。此时不应跳过后面的提子判断直接返回！
	* 无，假设放子。标记相接的1至3块Wb子的位置，分别进行死活判断isLive(Ww)?


进行打劫判断：
打劫是指当A方落子位置位于B方包围中，将B方pos位置的单子提掉之后，下一回合B方不能落子于pos位置将A上一手所下的子踢掉。

### 死活判断 isLive
    
标记本子已经探测过（也就是将坐标记录在案）。
    wsad四方向分别递归：
    1.如果是nu，返回活；
    2.如果是Ww，且无标记，就对其调用isLive(Ww)? （做上了标记）
    直到所有Ww都有了标记，返回死。
如果Ww全活，则判断Bb是否活（相接的3块中还有可能有Bb颜色的子，所以也要用isLive）。

### 胜负判断

只有在双方都停一手（认为无子可下）之后，才能判断胜负。（没有形势判断、棋形判断算法，因此只能先将所有死子吃尽。）
只数黑子的目数（countNumB）：
遍历棋盘落子点，判断黑子是否被记录，若无记录则添加进记录，然后从此位置出发，做与死活判断类似的递归。
将黑子目数与剩余目数比较，

## 其他

此外，还有显示棋盘、显示聊天内容 等功能。
由于时间关系，多房间模块、退出判负功能、形势判断功能、观战功能、账号等级功能、对弈限时功能、查阅聊天记录功能，都没有实现。
